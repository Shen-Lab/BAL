* Auto-generated CHARMM script.
*

! CHARMM input generated by charmm_setup.prl 
! ========================================== 
! Read in topology and parameter files
! ====================================

open read unit 1 card name "topology.inp"
read rtf card unit 1
close unit 1

open read unit 1 card name "parameter.inp"
read para card unit 1
close unit 1

open read unit 1 card name B.SEQ
read sequence unit 1 card
close unit 1
generate B first none last none setup 
stream "B_FIXRES.INP"

autogenerate angles dihedrals

scalar wmain = charge

open write unit 1 card name output0.psf
write psf card unit 1

open write unit 1 card name output0.ic
write ic card unit 1

open read unit 1 card name setup_in.crd 
read coor card unit 1 resid
close unit 1

! Check for and build in missing heavy atoms
! Build is done into default geometry from parameter file.
! ==========================================

define missing1 sele .not. ( init .or. hydrogen ) end
if ?nsel ne 0 print coor sele missing1 end

ic param
ic fill preserve
ic build

define missing2 sele .not. ( init .or. hydrogen ) end
if ?nsel ne 0 print coor sele missing2 end

! Build hydrogens
! Default parameters are rdiel of 4, with no cutoffs.
! ===================================================

hbuild sele hydrogen end -
  elec atom rdiel switch eps 4 -
  vdw vatom vswitch -
  cutnb 999 ctofnb 998 ctonnb 997 wmin 1.5 -
  e14fac 1 nbxmod 5

hbuild sele hydrogen end -
  elec atom rdiel switch eps 4 -
  vdw vatom vswitch -
  cutnb 999 ctofnb 998 ctonnb 997 wmin 1.5 -
  e14fac 1 nbxmod 5

update

! Write out structure, ic table and coordinates.
! ==============================================

scalar wmain = charge

open write unit 1 card name output0.crd
write coor card unit 1


stop

! End generated CHARMM input
! ==========================
